colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- sum(filter(predict(glmCGesch, data.frame(health='average',hosp=0))))
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- mean(predict(glmCGesch, data.frame(health='average',hosp=0)))
cGesch[1,1] <- mean(predict(glmCGesch, data.frame(health='poor',hosp=0)))
cGesch[3,1] <- mean(predict(glmCGesch, data.frame(health='excellent',hosp=0)))
cGesch[2,2] <- mean(predict(glmCGesch, data.frame(health='average',hosp=1)))
cGesch[1,2] <- mean(predict(glmCGesch, data.frame(health='poor',hosp=1)))
cGesch[3,2] <- mean(predict(glmCGesch, data.frame(health='excellent',hosp=1)))
cGesch
chisq.test(cBeob)
chisq.test(cGesch)
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- sum(predict(glmCGesch, data.frame(health='average',hosp=0)))
cGesch[1,1] <- sum(predict(glmCGesch, data.frame(health='poor',hosp=0)))
cGesch[3,1] <- sum(predict(glmCGesch, data.frame(health='excellent',hosp=0)))
cGesch[2,2] <- sum(predict(glmCGesch, data.frame(health='average',hosp=1)))
cGesch[1,2] <- sum(predict(glmCGesch, data.frame(health='poor',hosp=1)))
cGesch[3,2] <- sum(predict(glmCGesch, data.frame(health='excellent',hosp=1)))
cGesch
chisq.test(cBeob)
chisq.test(cGesch)
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- sum(predict(glmCGesch, data.frame(health='average',hosp=0),type = response))
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- sum(predict(glmCGesch, data.frame(health='average',hosp=0),type = 'response'))
cGesch[1,1] <- sum(predict(glmCGesch, data.frame(health='poor',hosp=0)))
cGesch[3,1] <- sum(predict(glmCGesch, data.frame(health='excellent',hosp=0)))
cGesch[2,2] <- sum(predict(glmCGesch, data.frame(health='average',hosp=1)))
cGesch[1,2] <- sum(predict(glmCGesch, data.frame(health='poor',hosp=1)))
cGesch[3,2] <- sum(predict(glmCGesch, data.frame(health='excellent',hosp=1)))
cGesch
chisq.test(cBeob)
chisq.test(cGesch)
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- (cBeob - 4406)
chisq.test(cBeob)
chisq.test(cBeob,p = cGesch)
chisq.test(cGesch)
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- ((cBeob[1,1]-4406*cGesch[1,1])^2)/(4406*cGesch[1,1])+((cBeob[2,1]-4406*cGesch[2,1])^2)/(4406*cGesch[2,1])+((cBeob[3,1]-4406*cGesch[3,1])^2)/(4406*cGesch[3,1])+((cBeob[1,2]-4406*cGesch[1,2])^2)/(4406*cGesch[1,2])+((cBeob[2,2]-4406*cGesch[2,2])^2)/(4406*cGesch[2,2])+((cBeob[3,2]-4406*cGesch[3,2])^2)/(4406*cGesch[3,2])
chisq
(cBeob[1,1]-4406*cGesch[1,1])^2)/(4406*cGesch[1,1])
((cBeob[1,1]-4406*cGesch[1,1])^2)/(4406*cGesch[1,1])
plot(poissreg2)
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- mean(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- mean(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- mean(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- mean(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- mean(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- mean(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- ((cBeob[1,1]-4406*cGesch[1,1])^2)/(4406*cGesch[1,1])+((cBeob[2,1]-4406*cGesch[2,1])^2)/(4406*cGesch[2,1])+((cBeob[3,1]-4406*cGesch[3,1])^2)/(4406*cGesch[3,1])+((cBeob[1,2]-4406*cGesch[1,2])^2)/(4406*cGesch[1,2])+((cBeob[2,2]-4406*cGesch[2,2])^2)/(4406*cGesch[2,2])+((cBeob[3,2]-4406*cGesch[3,2])^2)/(4406*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- mean(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- mean(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- mean(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- mean(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- mean(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- mean(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- ((cBeob[1,1]-cGesch[1,1])^2)/(cGesch[1,1])+((cBeob[2,1]-cGesch[2,1])^2)/(cGesch[2,1])+((cBeob[3,1]-cGesch[3,1])^2)/(cGesch[3,1])+((cBeob[1,2]-cGesch[1,2])^2)/(cGesch[1,2])+((cBeob[2,2]-cGesch[2,2])^2)/(cGesch[2,2])+((cBeob[3,2]-cGesch[3,2])^2)/(cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- mean(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- mean(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- mean(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- mean(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- mean(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- mean(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- ((cBeob[1,1]-cGesch[1,1])^2)/(cGesch[1,1])+
((cBeob[2,1]-cGesch[2,1])^2)/(cGesch[2,1])+
((cBeob[3,1]-cGesch[3,1])^2)/(cGesch[3,1])+
((cBeob[1,2]-cGesch[1,2])^2)/(cGesch[1,2])+
((cBeob[2,2]-cGesch[2,2])^2)/(cGesch[2,2])+
((cBeob[3,2]-cGesch[3,2])^2)/(cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- mean(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- mean(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- mean(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- mean(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- mean(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- mean(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
cGesch
chisq <- ((cBeob[1,1]-cGesch[1,1])^2)/(cGesch[1,1])+
((cBeob[2,1]-cGesch[2,1])^2)/(cGesch[2,1])+
((cBeob[3,1]-cGesch[3,1])^2)/(cGesch[3,1])+
((cBeob[1,2]-cGesch[1,2])^2)/(cGesch[1,2])+
((cBeob[2,2]-cGesch[2,2])^2)/(cGesch[2,2])+
((cBeob[3,2]-cGesch[3,2])^2)/(cGesch[3,2])
chisq
nk11 <- dim(filter(DebTrivedi,health=='average'&hosp==0)[1]
nk11 <- dim(filter(DebTrivedi,health=='average'&hosp==0)[1])
nk11 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- exp(predict(glmCGesch, data.frame(health='average',hosp=0)))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- exp(predict(glmCGesch, data.frame(health='poor',hosp=0)))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- exp(predict(glmCGesch, data.frame(health='excellent',hosp=0)))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- exp(predict(glmCGesch, data.frame(health='average',hosp=1)))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- exp(predict(glmCGesch, data.frame(health='poor',hosp=1)))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- exp(predict(glmCGesch, data.frame(health='excellent',hosp=1)))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
mean(exp(predict(poissreg2, data.frame(married='yes',medicaid='no',health='average',numchron=2, hosp=0))))
mean(predict(poissreg2, data.frame(married='yes',medicaid='no',health='average',numchron=2, hosp=0)))
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict(glmCGesch, data.frame(health='average',hosp=0))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict(glmCGesch, data.frame(health='poor',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict(glmCGesch, data.frame(health='excellent',hosp=0))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict(glmCGesch, data.frame(health='average',hosp=1))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict(glmCGesch, data.frame(health='poor',hosp=1))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict(glmCGesch, data.frame(health='excellent',hosp=1))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp)
cGesch[2,1] <- predict.glm(glmCGesch, data.frame(health='average',hosp=0))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=0))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict.glm(glmCGesch, data.frame(health='average',hosp=1))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=1))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=1))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp, family="poisson")
cGesch[2,1] <- predict.glm(glmCGesch, data.frame(health='average',hosp=0))
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=0))
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=0))
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict.glm(glmCGesch, data.frame(health='average',hosp=1))
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=1))
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=1))
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
library('dplyr')
cBeob <- matrix(NA,nrow=3,ncol=2)
colnames(cBeob) <- c("hosp 0","hosp 1")
rownames(cBeob) <- c("poor","average","excellent")
cGesch <- matrix(NA,nrow=3,ncol=2)
colnames(cGesch) <- c("hosp 0","hosp 1")
rownames(cGesch) <- c("poor","average","excellent")
cBeob[2,1] <- sum(filter(DebTrivedi,health=='average'&hosp==0)$ofp)
cBeob[1,1] <- sum(filter(DebTrivedi,health=='poor'&hosp==0)$ofp)
cBeob[3,1] <- sum(filter(DebTrivedi,health=='excellent'&hosp==0)$ofp)
cBeob[2,2] <- sum(filter(DebTrivedi,health=='average'&hosp==1)$ofp)
cBeob[1,2] <- sum(filter(DebTrivedi,health=='poor'&hosp==1)$ofp)
cBeob[3,2] <- sum(filter(DebTrivedi,health=='excellent'&hosp==1)$ofp)
cBeob
glmCGesch <- glm(data = DebTrivedi, ofp~health+hosp, family="poisson")
cGesch[2,1] <- predict.glm(glmCGesch, data.frame(health='average',hosp=0),type='response')
nk21 <- dim(filter(DebTrivedi,health=='average'&hosp==0))[1]
cGesch[1,1] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=0),type='response')
nk11 <- dim(filter(DebTrivedi,health=='poor'&hosp==0))[1]
cGesch[3,1] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=0),type='response')
nk31 <- dim(filter(DebTrivedi,health=='excellent'&hosp==0))[1]
cGesch[2,2] <- predict.glm(glmCGesch, data.frame(health='average',hosp=1),type='response')
nk22 <- dim(filter(DebTrivedi,health=='average'&hosp==1))[1]
cGesch[1,2] <- predict.glm(glmCGesch, data.frame(health='poor',hosp=1),type='response')
nk12 <- dim(filter(DebTrivedi,health=='poor'&hosp==1))[1]
cGesch[3,2] <- predict.glm(glmCGesch, data.frame(health='excellent',hosp=1),type='response')
nk32 <- dim(filter(DebTrivedi,health=='excellent'&hosp==1))[1]
cGesch
chisq <- ((cBeob[1,1]-nk11*cGesch[1,1])^2)/(nk11*cGesch[1,1])+
((cBeob[2,1]-nk21*cGesch[2,1])^2)/(nk21*cGesch[2,1])+
((cBeob[3,1]-nk31*cGesch[3,1])^2)/(nk31*cGesch[3,1])+
((cBeob[1,2]-nk12*cGesch[1,2])^2)/(nk12*cGesch[1,2])+
((cBeob[2,2]-nk22*cGesch[2,2])^2)/(nk22*cGesch[2,2])+
((cBeob[3,2]-nk32*cGesch[3,2])^2)/(nk32*cGesch[3,2])
chisq
